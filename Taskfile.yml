---
# https://taskfile.dev
version: '3'
tasks:
  default:
    desc: "Show all available tasks"
    cmds:
      - task --list
    silent: true
  render-template:
    desc: "Render template"
    cmds:
      - echo "Rendering template"
      - copier copy . ./copier_context --defaults
      - cp ./fixtures/Taskfile.yml ./copier_context/Taskfile.yml
      - cp ./fixtures/infra/pyproject.toml ./copier_context/infra/pyproject.toml
      - cp ./fixtures/infra/__init__.py ./copier_context/infra/infra/__init__.py
  install-dev:
    desc: "Install dev"
    cmds:
      - task: render-template
      - echo "Installing dev"
      - task: render-template
      - task agent_test:agent:install --dir copier_context
  test:
    desc: "Run tests"
    cmds:
      - task: install-dev
      - echo "Running tests"
      - task agent_test:agent:lint-check --dir copier_context
      - task agent_test:agent:test-coverage --dir copier_context
